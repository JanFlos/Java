/**
 * 
 */
package h2;

import constants.DataSourceTypeEnum;
import dml.Metadata;


/**
 * @author Jan Flos
 * 
 */
public class QueryDataSource {

    private String             _queryDataSource;
    private DataSourceTypeEnum _datasourceType;
    private String             _dmlTarget;
    private Metadata           _metadata;

    public QueryDataSource(String dataSource, String dmlTarget) {

        _datasourceType = DataSourceTypeEnum.FROM_QUERY_CLAUSE;

        if (_queryDataSource.matches("^[a-zA-Z]\\S*$")) {
            _datasourceType = DataSourceTypeEnum.TABLE;
            _dmlTarget = _queryDataSource;
        }
        
        if (_datasourceType == DataSourceTypeEnum.TABLE && _dmlTarget == null)
            _dmlTarget = _queryDataSource;
        
    }

    /**
     * @return
     */
    public Metadata getMetadata() {

        if (_metadata == null)
            _metadata = new Metadata(tableName, tableColumns, returningColumns, readOnlyColumns, primaryKeyColumns);

        return _metadata;
    }

}
